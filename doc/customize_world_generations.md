# 匠魂扩增 世界生成配置相关文档

在新版的匠魂扩增中, 我们将世界生成相关的配置从json文件合并到了forge配置系统.

如果需要修改世界生成, 请耐心阅读本文档.

## 调整

您可以在forge配置系统(也就是您在游戏主菜单中看到的mod配置界面)内修改配置项以调整世界生成.

当您保存世界生成配置后, 我们将会重载本模组的所有世界生成器.

> 重载世界生成器可能出现轻微卡顿现象

> 旧版(0.2.x)的匠魂扩增中, 我们允许通过配置文件新增某些矿物的生成, 新版(0.3.x)的匠魂扩增中这项功能被移除

## 全局设置

目录|名称|类型|作用
-|-|-|-
总体设置|enable_world_generations|布尔型|若为否, 则禁用所有世界生成
总体设置|blacklist_dim_generation|整型数组|在此输入若干维度id, 在相关维度中我们将不会进行任何世界生成
总体设置|blacklist_biome_generation|字符串数组|在此输入若干生物群系名称, 在相关生物群系中我们将不会进行任何世界生成

世界生成全局配置项**优于**其它所有自定义配置, 无论其设定如何.

> 比如, 假设全局配置中将*维度0*加入黑名单, 即使某自定义项设定某矿物仅在*维度0*生成, 我们也不会生成任何内容

## 单项设置

您可以为每一种矿物单独自定义其生成器的参数.

参数采用`key=value`的格式, 彼此之间使用**英文分号**分隔.

### 通用参数

键|可用值|默认值|含义
-|-|-|-
enable|`true|false`|`true`|是否启用此生成器
rate_chunk|`[0,1]`(小数)|`1`|每区块成功生成几率
time_chunk|`[0,)`(整数)|`1`|每区块尝试次数
rate_single|`[0,1]`(小数)|`1`|每次尝试成功几率
strategy_dim|([生成策略](#生成策略))|`NONE_BLACKLIST`|维度策略
strategy_biome|([生成策略](#生成策略))|`NONE_BLACKLIST`|生物群系策略
dims|整数数组, 以**逗号**分隔|`[]`|维度id列表
biomes|字符串数组, 以**逗号**分隔|`[]`|生物群系id列表
type|字符串|-|生成器类型

根据您提供的`type`属性的不同, 我们会决定创建何种生成器, 进而读取此种生成器的特有参数

> 如果某项参数没有默认值, 则此项为必填项, 下同

> 部分生成器的生成效率较低, 请不要过度调整生成频率等参数

需要注意的是, 每一个正确配置项都会创建一个生成器, 所以如果您设定两种矿物生成为云层生成器, 区块成功概率为0.01和0.03, 最终您将会有0.01+0.03=0.04的概率在一个区块中发现云层.

### 普通矿物生成 (type=common)

此生成器将会以类似原版矿物生成的形式向世界添加矿物. 大多数矿物的生成都使用此生成器.

键|可用值|默认值|含义
-|-|-|-
min_y|`[0,)`(整数)|-|最低Y轴生成
max_y|`[0,)`(整数)|-|最高Y轴生成
size|`[1,)`(整数)|-|最大生成数量
selector|([方块种类检查器](#方块种类检查器))|`stone`|我们将仅替换指定种类的方块

> `max_y`参数值需大于`min_y`参数值

示例配置

```
type=common; min=20; max=40; size=5; selector=stone
```

### 基岩矿物生成 (type=bedrock)

此生成器将会向基岩层添加矿物. 默认*破碎基岩*使用此生成器.

键|可用值|默认值|含义
-|-|-|-
size|`[1,)`(整数)|-|最大生成数量
rate|`[1,0]`(小数)|`0.8`|单次成功概率

> 此生成器仅替换石头、圆石方块

示例配置

```
type=bedrock; size=7; rate=0.5
```

### 海床矿物生成 (type=seabed)

此生成器将会向海床添加矿物. 默认*海草*使用此生成器.

此生成器无可配置项.

示例配置

```
type=seabed
```

### 云层矿物生成 (type=cloud)

此生成器将会创建云层并将矿物分布于云层内. 默认*云玉*使用此生成器.

键|可用值|默认值|含义
-|-|-|-
min_x|`[1,8]`(整数)|`3`|最小X轴长度
max_x|`[1,8]`(整数)|`6`|最大X轴长度
min_y|`[1,8]`(整数)|`1`|最小Y轴长度
max_y|`[1,8]`(整数)|`2`|最大Y轴长度
min_z|`[1,8]`(整数)|`3`|最小Z轴长度
max_z|`[1,8]`(整数)|`6`|最大Z轴长度
min_height|`[0,)`(整数)|`150`|最低生成高度
max_height|`[0,)`(整数)|`180`|最高生成高度
rate_ore|`[0,1]`(小数)|`0.00225`|云层方块生成为矿物的概率

> 此生成器仅替换逻辑空气方块

> 默认情况下仅有`0.015`的概率在区块生成*云玉*矿云层

示例配置

```
type=cloud; min_x=5; max_x=7; min_y=2
```

### 树根矿物生成 (type=tree_root)

此矿物将会向树木下方生成矿物. 默认*树根*使用此生成器.

键|可用值|默认值|含义
-|-|-|-
depth_base|`[1,)`(整数)|`3`|基础深度
depth_extra|`[1,)`(整数)|`3`|额外随机深度

> 此生成器会强行跳过寒冷和海洋生物群系的生成, 无论自定义配置如何

> 此生成器仅替换泥土、石头、圆石方块

示例配置

```
type=tree_root; depth_base=4; depth_extra=6;
```

### 岩浆球矿物生成 (type=lava_ball)

此生成器无可配置项.

示例配置

```
type=lava_ball
```

### 陨石矿物生成 (type=meteo)

> **陨石矿物生成**不是**陨石矿方块**

> 此生成器仍未实现

## 配置错误

如果某项配置项填写错误(如缺失某键值), 此项世界生成器的创建将会被跳过, 并且在日志中输出相关错误信息.

> 是的, 您可以通过故意输错某项配置项内容来跳过此配置项的加载, 但是我们更推荐使用`disable=true`的方式, 这样不会有多余的错误日志

所有的世界生成器配置错误信息都会以`An error occurred while creating world generator`开头, 后接详细错误内容.

可能出现的错误如下

错误信息|内容|可能的调整
-|-|-
The given value is below the minimum allowed|输入值低于允许的最小值|修改数值以契合范围
The given value is higher than the maximum allowed|输入值高于允许的最大值|修改数值以契合范围
Missing the specified key-value pair|缺失指定键值对|补充指定键值对
Invalid key-value pair|无效的键值对|移除指定键值对
Duplicate parameter|重复的键值对|移除指定键值对
Unimplemented generator type|计划中, 但仍未实现的生成器类型|使用其它类型生成器
Unknown world generator type|未知的世界生成器类型|使用正确世界生成器类型
Unexpected strategy value|错误的生成策略|使用正确生成策略
Missing float value|缺失小数|补充小数
Unexpected float value|小数转换失败|提供正确格式的小数
Missing integer value|缺失整数|补充整数
Unexpected integer value|整数转换失败|提供正确格式的整数

## 生成策略

我们提供了4种生成策略, 如下表所示

策略键|含义
-|-
ALWAYS|总是
ONLY_WHITELIST|仅当于白名单
NONE_BLACKLIST|当所有非黑名单
NONE|总不

> 使用`NONE`策略与`enable=false`的效果类似, 都会禁用此生成器的一切生成, 但是我们推荐使用`enable=false`以减少不必要的运算

## 生物群系组

我们预设了数个生物群系组, 供各种生成和逻辑判断使用.

* 平原
* 森林
* 恶地
* 高山
* 沙漠
* 水
* 海洋
* 水和海洋
* 特殊
* 炎热
* 温暖
* 普通温度
* 凉爽
* 寒冷

> 目前只能修改生物群系组, 不能新增或删除组

> 如果想查看当前游戏环境内所有可用的生物群系id, 请使用指令`/tiths biomes`, 参见模组指令介绍界面

## 方块种类检查器

我们预设了数个方块种类检查器, 在部分生成器中可用于控制世界生成, 避免替换掉不想替换的方块.

键|检查范围
-|-
any|可以替换任何方块
none|不会替换任何方块
air|空气方块
any_stone|石头或圆石
stone|石头
cobble_stone|圆石
end_stone|末地石
netherrack|地狱岩
grass|草方块
dirt|泥土
sand|沙子
lava|岩浆
magma|岩浆块

